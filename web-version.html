<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chess Game Analyzer - donnybadamo.com</title>
  <link rel="stylesheet" href="analysis.css">
  <style>
    .pgn-input-section {
      padding: 30px;
      background: rgba(255, 255, 255, 0.05);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .pgn-input-section h2 {
      color: white;
      margin-bottom: 15px;
    }
    .pgn-input-container {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    .pgn-textarea {
      flex: 1;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      color: white;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      resize: vertical;
      min-height: 100px;
    }
    .pgn-textarea::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }
    .pgn-buttons {
      display: flex;
      gap: 10px;
    }
    .btn-analyze {
      background: #ff6b35;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .btn-analyze:hover {
      background: #ff8555;
      transform: translateY(-2px);
    }
    .btn-analyze:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .btn-paste {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    .btn-paste:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    .example-text {
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Chess Game Analyzer</h1>
        <div style="font-size: 12px; opacity: 0.7; margin-top: 5px;"><a href="https://donnybadamo.com" target="_blank" style="color: inherit; text-decoration: none;">donnybadamo.com</a></div>
      </div>
      <div class="controls">
        <button id="playBtn" class="btn btn-primary">‚ñ∂ Play</button>
        <button id="pauseBtn" class="btn btn-secondary">‚è∏ Pause</button>
        <button id="stopBtn" class="btn btn-secondary">‚èπ Stop</button>
        <button id="prevBtn" class="btn btn-secondary">‚óÄ Previous</button>
        <button id="nextBtn" class="btn btn-secondary">Next ‚ñ∂</button>
        <label class="voice-control">
          <input type="checkbox" id="voiceToggle" checked> Voice
        </label>
      </div>
    </header>

    <div class="pgn-input-section">
      <h2>Paste Game PGN</h2>
      <div class="pgn-input-container">
        <textarea id="pgnInput" class="pgn-textarea" placeholder="Paste your game PGN here...&#10;&#10;Example:&#10;[Event &quot;Live Chess&quot;]&#10;[Site &quot;lichess.org&quot;]&#10;[Date &quot;2024.12.22&quot;]&#10;[White &quot;Player1&quot;]&#10;[Black &quot;Player2&quot;]&#10;[Result &quot;1-0&quot;]&#10;&#10;1. e4 e5 2. Nf3 Nc6 3. Bb5..."></textarea>
      </div>
      <div class="pgn-buttons">
        <button id="pasteBtn" class="btn-paste">üìã Paste from Clipboard</button>
        <button id="analyzeBtn" class="btn-analyze">üîç Analyze Game</button>
      </div>
      <div class="example-text">
        üí° Tip: On Lichess, click the "Copy PGN" button added by the extension, then paste it here.
      </div>
    </div>

    <div class="main-content" id="mainContent" style="display: none;">
      <div class="board-container">
        <div id="board"></div>
        <div class="board-info">
          <div id="evaluation" class="evaluation-bar">
            <div id="evalBar" class="eval-fill"></div>
            <span id="evalText">+0.0</span>
          </div>
        </div>
      </div>

      <div class="moves-panel">
        <h2>Moves</h2>
        <div id="movesList" class="moves-list"></div>
      </div>
    </div>

    <div class="analysis-info" id="analysisInfo" style="display: none;">
      <div class="info-section">
        <h3>Game Info</h3>
        <div id="gameInfo"></div>
      </div>
    </div>
  </div>

  <!-- Load libraries from CDN for web version (only works when hosted on website, not in extension) -->
  <script>
    // Check if we're in extension context
    if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.id) {
      document.body.innerHTML = '<div style="padding: 40px; text-align: center; color: white;"><h2>Wrong File</h2><p>This is the web version for hosting on your website.</p><p>The extension uses analysis.html instead.</p></div>';
    } else {
      // Load libraries dynamically for website hosting
      const loadScript = (src) => {
        return new Promise((resolve, reject) => {
          const script = document.createElement('script');
          script.src = src;
          script.onload = resolve;
          script.onerror = reject;
          document.head.appendChild(script);
        });
      };
      
      const loadCSS = (href) => {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = href;
        document.head.appendChild(link);
      };
      
      // Load CSS
      loadCSS('https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css');
      
      // Load scripts in order
      Promise.all([
        loadScript('https://code.jquery.com/jquery-3.6.0.min.js'),
        loadScript('https://cdn.jsdelivr.net/npm/chess.js@1.0.0-beta.6/dist/chess.min.js').then(() => {
          // Make Chess available globally
          if (typeof Chess !== 'undefined') {
            window.Chess = Chess;
          }
        }),
        loadScript('https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js')
      ]).then(() => {
        // Load analysis script
        return loadScript('web-analysis.js');
      }).catch(err => {
        console.error('Error loading libraries:', err);
        document.body.innerHTML = '<div style="padding: 40px; text-align: center; color: white;"><h2>Error Loading</h2><p>Could not load required libraries.</p><p style="color: #ff6b35;">' + err.message + '</p></div>';
      });
    }
  </script>
</body>
</html>

